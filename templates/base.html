{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="theme-color" content="#011852" />
    <meta name="color-scheme" content="light dark" />
    <link rel="canonical" href="{{ request.build_absolute_uri }}" />

    <!-- ðŸ”¹ SEO -->
    <meta
      name="description"
      content="{% block meta_description %}Creator of the Djangify Digital eCommerce Builder. Full-stack Django developer{% endblock %}"
    />
    <meta
      name="keywords"
      content="{% block meta_keywords %}Django, Python, TailwindCSS, eCommerce, Mini eCommerce Builder, digital ecommerce builder, self-hosting, local-first, Full-Stack Developer UK, AI Search Readiness, Diane Corriette{% endblock %}"
    />
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large" />
    <meta name="author" content="Diane Corriette" />

    <!-- ðŸ”¹ Open Graph / Twitter -->
    {% block open_graph_tags %}
    <meta property="og:site_name" content="ToDiane" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Diane Corriette â€“ Full-stack Django developer & creator of the Djangify eCommerce Builder." />
    <meta property="og:description" content="Full-stack Django developer & creator of the Djangify eCommerce Builder." />
    <meta property="og:url" content="{{ request.build_absolute_uri }}" />
    <meta property="og:image" content="{{ request.scheme }}://{{ request.get_host }}/static/images/todiane-purp.webp" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="ToDiane â€“ Django Sofware Developer Â· Offline-First Advocate" />
    <meta name="twitter:description" content="Creator of Djangify eCommerce Builder. Full-stack Django developer." />
    <meta name="twitter:image" content="{{ request.scheme }}://{{ request.get_host }}/static/images/todiane-purp.webp" />
    {% endblock %}

    <!-- ðŸ”¹ Preload & optimise styles - Stripe url in checkout.html -->
    <link rel="stylesheet" href="{% static 'css/output.css' %}">

    <!-- Favicon -->
    <link rel="icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon" />

    <title>{% block title %}Diane Corriette â€“ Django Developer Â· Founder - Djangify Digital eCommerce Builder{% endblock %}</title>
    {% block extra_meta %}{% endblock %}

    <!-- ðŸ”¹ JSON-LD Website Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "ToDiane",
      "url": "{{ request.scheme }}://{{ request.get_host }}/",
      "author": {
        "@type": "Person",
        "name": "Diane Corriette"
      },
      "description": "Django Developer Â· Specialising in digital eCommerce stores, software, and Python web systems.",
      "publisher": {
        "@type": "Organization",
        "name": "ToDiane"
      }
    }
    </script>
  </head>

  <body class="antialiased bg-[color:var(--color-surface-light)] text-[color:var(--color-font-main)]">
      <a href="#main-content" 
        style="position: absolute; 
              left: -9999px; 
              width: 1px; 
              height: 1px; 
              overflow: hidden;"
        onfocus="this.style.cssText='position: absolute; top: 10px; left: 10px; z-index: 9999; background: #1e3a8a; color: white; padding: 8px 16px; border-radius: 4px; font-weight: 600;'"
        onblur="this.style.cssText='position: absolute; left: -9999px; width: 1px; height: 1px; overflow: hidden;'">
          Skip to main content
      </a>
    {% if messages %}
      <section aria-label="Notifications" role="alert">
        {% include 'partials/_messages.html' %}
      </section>
    {% endif %}

    <!-- Navigation -->
    {% if request and request.user.is_authenticated %}
        {% include "accounts/includes/logged_in_public_header.html" %}
    {% else %}
        {% include "components/navbar.html" %}
    {% endif %}

    <main id="main-content" tabindex="-1">
        {% block content %}{% endblock %}
    </main>

    {% include 'components/footer.html' %}

    <!-- ðŸ”¹ Cookie Consent (modern square version) -->
    <div
      id="cookie-banner"
      class="cookie-banner hidden fixed bottom-6 right-6 w-[320px] max-w-[90%] z-50 
            bg-[color:var(--color-brand-light)] text-[color:var(--color-font-main)] 
            border border-[color:var(--color-brand-accent)] rounded-2xl  
            p-6  flex-col gap-4"
      role="dialog"
      aria-labelledby="cookie-title"
      aria-modal="true"
      aria-hidden="true"
    >
      <div class="cookie-text text-sm leading-relaxed">
        <h2 id="cookie-title" class="font-semibold text-base mb-2">
          Cookie Consent
        </h2>
        <p>
          This site uses cookies to enhance your experience while you visit. By clicking Accept,  
          you consent to our use of cookies. 
          <a
            {% comment %} href="{% url 'infopages:cookie_policy' %}" {% endcomment %}
            class="text-[color:var(--color-brand-primary)] hover:text-[color:var(--color-brand-accent)] underline"
          >
            Cookie Policy
          </a>
        </p>
      </div>

      <div class="cookie-actions flex justify-end mt-4 gap-3">
      
        <button
          id="accept-cookies"
          class="px-4 py-2 bg-[color:var(--color-brand-primary)] text-[color:var(--color-brand-light)] 
                rounded-lg hover:bg-[color:var(--color-brand-accent)] transition"
        >
          Accept
        </button>
        <button
          id="decline-cookies"
          class="px-4 py-2 border border-[color:var(--color-brand-secondary)] 
                text-[color:var(--color-font-main)] rounded-lg hover:bg-[color:var(--color-brand-primary)] 
                hover:text-[color:var(--color-font-main)] transition"
        >
          Decline
        </button>
      </div>
    </div>
    <div id="gallery-modal" 
      class="hidden fixed inset-0 bg-black/80 z-50 items-center justify-center"
      hx-target="this"
      hx-swap="innerHTML">
    </div>

    <div id="gallery-modal"></div>
    <script src="https://unpkg.com/htmx.org@1.9.12" defer></script>

 
    <!-- ðŸ”¹ Deferred JS -->
    <script src="{% static 'js/app.js' %}" defer></script>
    <script src="{% static 'js/gallery.js' %}"defer></script>
    <script src="{% static 'js/messages.js' %}" defer></script>
    <script src="{% static 'js/category-filter.js' %}" defer></script>
   

    <!-- ðŸ”¹ Cookie Logic -->
    <script>
      (function () {
        function ready(fn) {
          if (document.readyState !== "loading") fn();
          else document.addEventListener("DOMContentLoaded", fn);
        }
        ready(() => {
          const banner = document.getElementById("cookie-banner");
          if (!banner) return;
          const accept = document.getElementById("accept-cookies");
          const decline = document.getElementById("decline-cookies");
          let decision = localStorage.getItem("cookieConsent");
          if (decision === "accepted" || decision === "declined") {
            banner.remove();
            return;
          }
          banner.style.display = "block";
          banner.setAttribute("aria-hidden", "false");

          const setConsent = (val) => {
            localStorage.setItem("cookieConsent", val);
            banner.remove();
          };
          accept?.addEventListener("click", (e) => {
            e.preventDefault();
            setConsent("accepted");
          });
          decline?.addEventListener("click", (e) => {
            e.preventDefault();
            setConsent("declined");
          });
        });
      })();
    </script>

    <div id="toast"
     class="fixed bottom-6 right-6 hidden bg-white border border-[color:var(--color-brand-secondary)] shadow-lg rounded-lg px-4 py-3 text-sm z-50">
</div>

<script>
  function showToast(message) {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.classList.remove('hidden');

    setTimeout(() => {
      toast.classList.add('hidden');
    }, 3000);
  }
</script>


    {% block extra_js %}{% endblock %}
    
  </body>
</html>
